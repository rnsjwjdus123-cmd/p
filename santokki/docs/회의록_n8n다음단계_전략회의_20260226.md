# 🎯 Santokki n8n 자동화 파이프라인 다음 단계 전략 회의

**참여 에이전트:** 기획자, 비즈니스 분석가, 크리에이티브 디렉터, 비판적 검토자
**논의 주제:** `n8n_handoff.md` 기반 다음 작업 진행 방향 및 블로커(알고리즘, 질문, URL) 해결 방안

---

## 📋 Step 1: 의제 설정 (기획자)
현재 파이프라인의 백엔드 로직 조각들은 완성되었으나, 3가지 블로커(매칭 알고리즘, 설문 질문, 실 매장 URL)가 있어 완성된 형태의 n8n 파이프라인 조립이 지연될 우려가 있습니다. 따라서 다음 3가지 핵심 논점을 설정합니다.

1. **n8n 워크플로우 임시 구축 방안:** 미완성 로직을 대체하여 파이프라인을 먼저 연결할 방법은 무엇인가?
2. **설문 퀴즈 페이지(Firebase) 선행 개발:** 질문이 확정되지 않은 상태에서 퀴즈 페이지를 어디까지 개발할 것인가?
3. **Product Shop URL 부재 대응 전략:** 스토어 셋업 전까지의 트래픽을 어떻게 처리할 것인가?

---

## 📊 Step 2: 비즈니스 분석 (비즈니스 분석가)

*   **n8n 워크플로우 구성 (ROI 관점):**
    완벽한 알고리즘을 기다리는 것은 Time-to-Market 측면에서 손해입니다. n8n Cloud를 가입하고 현재 `product_matcher.py`에 있는 '임시 매칭 알고리즘'과 더미 데이터를 기반으로 **End-to-End 테스트 환경을 즉시 구축**해야 합니다. 파이프라인의 안정성이 확인되면 알고리즘 교체는 노드 하나만 수정하면 되므로 매우 효율적입니다.
*   **설문 퀴즈 페이지 테스트:**
    사용자 경험(UX) 최적화와 ManyChat → Firebase Hosting → Firestore로 이어지는 데이터 흐름 테스트가 당장의 매칭 로직보다 훨씬 중요합니다. 임시 질문 3개(분위기, 장소, 강도)를 사용하여 퀴즈 페이지 프론트엔드 개발을 바로 시작해야 합니다.
*   **Shop URL 대응:**
    당장 제품을 팔 수 없다면, 해당 트래픽을 버리지 말고 '사전 예약(Pre-order)' 또는 '알림 받기' 리드(Lead) 수집용 랜딩 페이지로 우회시키는 것이 비즈니스적으로 이득입니다.

---

## 💡 Step 3: 크리에이티브 제안 (크리에이티브 디렉터)

*   **LLM 기반 초개인화 (n8n OpenAI 노드 활용):**
    매칭 알고리즘이 완성되더라도, 사용자에게 전송되는 DM은 정적인 텍스트 템플릿입니다. n8n 워크플로우 중간에 AI 노드를 추가하여, 유저의 퀴즈 답변을 기반으로 "당신의 분위기에 어울리는 특별한 이유"를 한 줄로 자동 작성해 DM에 포함시키면 전환율을 극대화할 수 있습니다.
*   **가계정/티저 페이지 활용 (URL 공백 메우기):**
    Shop URL이 없다면 제품의 무드보드나 향수의 원료 스토리를 보여주는 '노션 매거진(Notion) 형태의 티저 페이지'를 연결하여 기대감을 높일 수 있습니다.

---

## ⚠️ Step 4: 비판적 검토 (비판적 검토자)

*   **LLM 연동의 리스크 (비용 및 지연):**
    크리에이티브 디렉터의 AI 노드 제안은 매력적이지만, LLM 호출은 시간 지연(Latency)이 발생하며 때에 따라 타임아웃 오류를 일으켜 DM 전송 자체를 실패하게 만들 수 있습니다. MVP 단계에서는 극도의 안정성이 필요하므로 정적 템플릿(현재의 `dm_messages.py` 구조)을 먼저 완벽히 성공시킨 후, 추후 고도화 단계에서 고려해야 합니다.
*   **티저 페이지 연결의 함정:**
    Shop URL을 티저 페이지로 변경할 경우, ManyChat의 DM 발송 메시지 템플릿(`dm_messages.py`)의 문구가 "👉 Shop now: {{shop_url}}" 로 되어 있어 인지 부조화가 발생합니다. 링크 목적지에 맞춰 ManyChat 템플릿의 Call to Action(CTA) 텍스트를 "👉 Discover your scent" 등으로 즉시 수정해야 합니다.
*   **Firestore 데이터 구조 불일치 위험:**
    알고리즘을 임시로 사용할 때, 반드시 Firestore로 전달되는 JSON 구조(`id`, `name`, `price_eur` 등)가 최종 알고리즘 출력과 100% 동일한 컨트랙트(Contract)를 유지해야 워크플로우 재작업을 막을 수 있습니다.

---

## ✅ Step 5: 최종 종합 & Action Items (기획자)

논의 결과를 바탕으로 현재 상황에서의 최적의 다음 단계를 도출했습니다. 무작정 대기하지 않고 즉시 실행할 수 있는 병렬 작업에 집중합니다.

**🚀 즉시 실행할 Action Items:**

1.  **n8n End-to-End 파이프라인 임시 구축 (우선순위 1):**
    *   n8n에 임시 매칭 로직(`product_matcher.py`)을 JavaScript 코드로 변환하여 Code 노드에 삽입.
    *   트리거(Firestore)부터 타겟(ManyChat DM)까지 데이터가 정상적으로 흐르는지 즉시 뼈대 연결 및 테스트 진행.
2.  **임시 데이터용 퀴즈 페이지 프론트엔드 개발:**
    *   최종 질문 확정을 기다리지 말고, 현재 설계된 3가지 지표(mood, location, intensity)를 기준으로 Firebase Hosting용 퀴즈 페이지 UI/UX 개발 시작.
3.  **ManyChat 메시지 템플릿 CTA 임시 수정:**
    *   실제 스토어가 없으므로 `products.json`의 `shop_url`을 브랜드 인스타그램이나 노션 소개 페이지 등으로 임시 연결.
    *   이에 맞춰 DM 메시지 발송 내용의 "Shop now" 텍스트를 "Discover more" 등으로 수정하여 사용자 혼란 방지.
