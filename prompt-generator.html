<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Santokki Â· ê´‘ê³ /ê²Œì‹œê¸€ í”„ë¡¬í”„íŠ¸ ìƒì„±</title>
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;500;600;700&family=Cormorant+Garamond:wght@600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg: #fafaf9; --card: #fff; --border: #e7e5e4; --text: #1c1917; --text2: #57534e; --accent: #1e5c3a; --accent-light: #f0f7f4;
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: 'Outfit', sans-serif; background: var(--bg); color: var(--text); line-height: 1.6; padding: 24px; }
    h1 { font-family: 'Cormorant Garamond', serif; font-size: 1.75rem; margin-bottom: 8px; color: var(--text); }
    .sub { font-size: 0.875rem; color: var(--text2); margin-bottom: 24px; }
    .card { background: var(--card); border: 1px solid var(--border); border-radius: 8px; padding: 20px 24px; margin-bottom: 16px; }
    .card h2 { font-size: 0.8rem; text-transform: uppercase; letter-spacing: .05em; color: var(--text2); margin-bottom: 10px; }
    label { display: block; font-size: 0.8rem; font-weight: 500; color: var(--text2); margin-bottom: 6px; }
    input, textarea { width: 100%; padding: 10px 12px; border: 1px solid var(--border); border-radius: 6px; font-family: inherit; font-size: 0.9rem; }
    textarea { min-height: 80px; resize: vertical; }
    .row { display: flex; gap: 12px; flex-wrap: wrap; align-items: flex-end; margin-bottom: 12px; }
    .row > * { flex: 1; min-width: 120px; }
    button {
      background: var(--accent); color: #fff; border: none; padding: 10px 20px; border-radius: 6px;
      font-family: inherit; font-weight: 600; font-size: 0.9rem; cursor: pointer;
    }
    button:hover { background: #153d28; }
    button.secondary { background: var(--card); color: var(--text); border: 1px solid var(--border); }
    button.secondary:hover { background: var(--accent-light); color: var(--accent); }
    .result { margin-top: 24px; }
    .result-block { background: var(--accent-light); border: 1px solid #b3d7c7; border-radius: 8px; margin-bottom: 8px; overflow: hidden; }
    .result-block h3 { font-size: 0.85rem; color: var(--accent); margin: 0; }
    .result-block pre { white-space: pre-wrap; word-break: break-word; font-size: 0.85rem; color: var(--text); margin: 0; }
    .copy-btn { padding: 6px 12px; font-size: 0.75rem; flex-shrink: 0; }
    .result-toggle-header { display: flex; align-items: center; justify-content: space-between; gap: 8px; padding: 12px 14px; cursor: pointer; user-select: none; }
    .result-toggle-header:hover { background: rgba(30,92,58,.06); }
    .result-toggle-header .title-wrap { flex: 1; min-width: 0; }
    .result-toggle-header .result-toggle-icon { color: var(--text2); font-size: 0.7rem; transition: transform .2s ease; flex-shrink: 0; }
    .result-toggle.open .result-toggle-icon { transform: rotate(0deg); }
    .result-toggle:not(.open) .result-toggle-icon { transform: rotate(-90deg); }
    .result-toggle-body { max-height: 0; overflow: hidden; transition: max-height .25s ease; }
    .result-toggle.open .result-toggle-body { max-height: 1200px; }
    .result-toggle-body-inner { padding: 0 14px 14px; padding-top: 0; }
    .result-toggle-body pre { padding: 10px 0 4px; }
    .error { background: #fef2f2; border-color: #fecaca; color: #dc2626; }
    .loading { opacity: 0.7; pointer-events: none; }
  </style>
</head>
<body>
  <h1>Santokki ê´‘ê³  Â· ê²Œì‹œê¸€ í”„ë¡¬í”„íŠ¸ ìƒì„±</h1>
  <p class="sub">ëŒ€ì‹œë³´ë“œ í†µê³„ë¥¼ ë„£ìœ¼ë©´ ìµœì  ìƒí’ˆ + 15ì´ˆ ê´‘ê³  ìŠ¤í¬ë¦½íŠ¸ + í”¼ë“œ ê²Œì‹œê¸€ìš© ì¹´í”¼ê°€ ìƒì„±ë©ë‹ˆë‹¤. ìœ ëŸ½ SNS(ì¸ìŠ¤íƒ€Â·XÂ·í‹±í†¡)ì— ë§ì¶˜ ë¬¸êµ¬ë¡œ ìƒì„±ë©ë‹ˆë‹¤.</p>

  <div class="card">
    <h2>ìë™ ìƒì„± (ì‹œí–¥ í…ŒìŠ¤íŠ¸ 10ëª… ì´ìƒ ì‹œ)</h2>
    <p style="font-size:0.8rem;color:var(--text2);margin-bottom:10px">Firebaseì— ì €ì¥ëœ ì‹œí–¥ í…ŒìŠ¤íŠ¸ ê²°ê³¼ê°€ 10ëª… ì´ìƒì´ë©´, ê·¸ í†µê³„ë¥¼ ë°”íƒ•ìœ¼ë¡œ ë°”ë¡œ í”„ë¡¬í”„íŠ¸ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.</p>
    <button type="button" id="btnFirebase">Firebase í†µê³„ë¡œ ìë™ ìƒì„±</button>
    <p id="firebaseStatus" style="font-size:0.8rem;color:var(--text2);margin-top:8px;display:none"></p>
  </div>

  <div class="card">
    <h2>ëŒ€ì‹œë³´ë“œ í†µê³„ ì…ë ¥ (ìˆ˜ë™)</h2>
    <p style="font-size:0.8rem;color:var(--text2);margin-bottom:12px">ëŒ€ì‹œë³´ë“œì—ì„œ í™•ì¸í•œ ë‚´ìš©ì„ ì•„ë˜ í˜•ì‹ì— ë§ì¶° ë„£ê±°ë‚˜, ì˜ˆì‹œë¡œ ì±„ìš°ê¸° í›„ ìƒì„± ë²„íŠ¼ì„ ëˆ„ë¥´ì„¸ìš”.</p>
    <div class="row">
      <div>
        <label>ì¸ê¸° í–¥ (ì‰¼í‘œë¡œ)</label>
        <input type="text" id="topScents" placeholder="GREEN, FLORAL, FRESH">
      </div>
      <div>
        <label>ì¸ê¸° ë§¤ì¹­ ì œí’ˆ (ì‰¼í‘œë¡œ)</label>
        <input type="text" id="topProducts" placeholder="ë‚¨ì‚°ì˜ ìƒˆë²½ ì•ˆê°œ, ê³µì£¼ì˜ í™”ì›">
      </div>
    </div>
    <div class="row">
      <div>
        <label>ì´ ì‘ë‹µ ìˆ˜</label>
        <input type="number" id="totalResponses" placeholder="128" value="128">
      </div>
      <div>
        <label>ê¸°ê°„</label>
        <input type="text" id="period" placeholder="7d" value="7d">
      </div>
    </div>
    <div style="margin-top:12px">
      <label>ì¶”ê°€ í†µê³„ (ì„ íƒ, JSON)</label>
      <textarea id="extraStats" placeholder='{"genderRatio":{"female":70,"male":30},"spaceRatio":{"living_bedroom":50,"kitchen":30,"car":20}}'></textarea>
    </div>
    <div style="margin-top:16px;display:flex;gap:8px">
      <button type="button" id="btnSample">ì˜ˆì‹œë¡œ ì±„ìš°ê¸°</button>
      <button type="button" id="btnGenerate">ìƒì„±í•˜ê¸°</button>
    </div>
  </div>

  <div id="resultArea" class="result" style="display:none">
    <div class="card">
      <h2>ìƒì„± ê²°ê³¼</h2>
      <p style="font-size:0.8rem;color:var(--text2);margin-bottom:12px">ì œëª©ì„ í´ë¦­í•˜ë©´ í¼ì¹˜ê±°ë‚˜ ì ‘ì„ ìˆ˜ ìˆì–´ìš”.</p>

      <div id="resultOptimal" class="result-block result-toggle open" style="display:none">
        <div class="result-toggle-header">
          <div class="title-wrap"><h3>ìµœì  ìƒí’ˆ</h3></div>
          <button type="button" class="copy-btn secondary" data-copy="outOptimal">ë³µì‚¬</button>
          <span class="result-toggle-icon" aria-hidden="true">â–¼</span>
        </div>
        <div class="result-toggle-body"><div class="result-toggle-body-inner"><pre id="outOptimal"></pre></div></div>
      </div>

      <div id="resultAd" class="result-block result-toggle" style="display:none">
        <div class="result-toggle-header">
          <div class="title-wrap"><h3>15ì´ˆ ê´‘ê³  ìŠ¤í¬ë¦½íŠ¸</h3></div>
          <button type="button" class="copy-btn secondary" data-copy="outAd">ë³µì‚¬</button>
          <span class="result-toggle-icon" aria-hidden="true">â–¼</span>
        </div>
        <div class="result-toggle-body"><div class="result-toggle-body-inner"><pre id="outAd"></pre></div></div>
      </div>

      <div id="resultFeed" class="result-block result-toggle" style="display:none">
        <div class="result-toggle-header">
          <div class="title-wrap"><h3>ê²Œì‹œê¸€ìš© ì¹´í”¼ (ìº¡ì…˜ + í•´ì‹œíƒœê·¸)</h3></div>
          <button type="button" class="copy-btn secondary" data-copy="outFeed">ë³µì‚¬</button>
          <span class="result-toggle-icon" aria-hidden="true">â–¼</span>
        </div>
        <div class="result-toggle-body"><div class="result-toggle-body-inner"><pre id="outFeed"></pre></div></div>
      </div>

      <div id="resultSeo" class="result-block result-toggle" style="display:none">
        <div class="result-toggle-header">
          <div class="title-wrap"><h3>SEO ê²Œì‹œê¸€ (í‚¤ì›Œë“œÂ·ì´ë¯¸ì§€ ê²½ë¡œ)</h3></div>
          <button type="button" class="copy-btn secondary" data-copy="outSeo">ë³µì‚¬</button>
          <span class="result-toggle-icon" aria-hidden="true">â–¼</span>
        </div>
        <div class="result-toggle-body"><div class="result-toggle-body-inner"><p style="font-size:0.8rem;color:var(--text2);margin-bottom:6px">ë¸”ë¡œê·¸Â·SNSìš© ì œëª©Â·ë³¸ë¬¸Â·í•´ì‹œíƒœê·¸ + assets ì´ë¯¸ì§€ ê²½ë¡œ.</p><pre id="outSeo"></pre></div></div>
      </div>

      <div style="margin-top:16px;padding-top:16px;border-top:1px solid var(--border)">
        <button type="button" id="btnFormat" class="secondary" style="display:none">ì¸ìŠ¤íƒ€Â·ë¸”ë¡œê·¸ìš©ìœ¼ë¡œ ì˜ˆì˜ê²Œ ë§Œë“¤ê¸°</button>
        <p style="font-size:0.8rem;color:var(--text2);margin-top:8px">ìœ„ ê²°ê³¼ë¥¼ ë°”íƒ•ìœ¼ë¡œ ì¸ìŠ¤íƒ€ ìº¡ì…˜Â·ë„¤ì´ë²„ ë¸”ë¡œê·¸ì— ë°”ë¡œ ë¶™ì—¬ë„£ê¸° ì¢‹ì€ í˜•íƒœë¡œ ë‹¤ì‹œ ë§Œë“¤ì–´ìš”.</p>
      </div>

      <div id="resultInstagram" class="result-block result-toggle" style="display:none;margin-top:12px">
        <div class="result-toggle-header">
          <div class="title-wrap"><h3>ğŸ“· Instagramìš© (ë°”ë¡œ ë¶™ì—¬ë„£ê¸°)</h3></div>
          <button type="button" class="copy-btn secondary" data-copy="outInstagram">ë³µì‚¬</button>
          <span class="result-toggle-icon" aria-hidden="true">â–¼</span>
        </div>
        <div class="result-toggle-body"><div class="result-toggle-body-inner"><pre id="outInstagram"></pre></div></div>
      </div>

      <div id="resultNaver" class="result-block result-toggle" style="display:none">
        <div class="result-toggle-header">
          <div class="title-wrap"><h3>ğŸ“ ë„¤ì´ë²„ ë¸”ë¡œê·¸ìš© (ë°”ë¡œ ë¶™ì—¬ë„£ê¸°)</h3></div>
          <button type="button" class="copy-btn secondary" data-copy="outNaver">ë³µì‚¬</button>
          <span class="result-toggle-icon" aria-hidden="true">â–¼</span>
        </div>
        <div class="result-toggle-body"><div class="result-toggle-body-inner"><pre id="outNaver"></pre></div></div>
      </div>
    </div>
  </div>

  <div id="errorArea" class="card error" style="display:none">
    <strong>ì˜¤ë¥˜</strong>
    <pre id="errorText"></pre>
  </div>

  <script>
    const API_BASE = ''; // same origin
    let lastGeneratedResult = null; // ì•ì„  í”„ë¡¬í”„íŠ¸ ìƒì„± ê²°ê³¼ (ì˜ˆì˜ê²Œ ë§Œë“¤ê¸°ìš©)
    let lastGeneratedStats = null;   // ëŒ€ì‹œë³´ë“œ ì…ë ¥ê°’ (ì¸ê¸° í–¥Â·ì œí’ˆ) â€” APIê°€ ìµœì  ê²°ê³¼ ë‚´ë„ë¡ ì „ë‹¬

    document.getElementById('btnFirebase').onclick = async () => {
      const statusEl = document.getElementById('firebaseStatus');
      statusEl.style.display = 'block';
      statusEl.textContent = 'Firebase í†µê³„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘â€¦';
      statusEl.style.color = 'var(--text2)';
      document.body.classList.add('loading');
      const wrap = document.getElementById('resultArea');
      const errWrap = document.getElementById('errorArea');
      errWrap.style.display = 'none';
      wrap.style.display = 'none';
      document.getElementById('btnFormat').style.display = 'none';
      document.getElementById('resultInstagram').style.display = 'none';
      document.getElementById('resultNaver').style.display = 'none';
      try {
        const res = await fetch(API_BASE + '/api/stats-from-firebase');
        const data = await res.json();
        if (!data.ok || data.count < 10) {
          statusEl.textContent = data.message || 'ì‹œí–¥ í…ŒìŠ¤íŠ¸ ì‘ë‹µì´ 10ëª… ì´ìƒì¼ ë•Œë§Œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. (í˜„ì¬ ' + (data.count ?? 0) + 'ëª…)';
          statusEl.style.color = '#b45309';
          document.body.classList.remove('loading');
          return;
        }
        statusEl.textContent = 'í†µê³„ ë°˜ì˜ë¨ (' + data.count + 'ëª…). í”„ë¡¬í”„íŠ¸ ìƒì„± ì¤‘â€¦';
        const genRes = await fetch(API_BASE + '/api/generate-prompts', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ stats: data.stats })
        });
        const genData = await genRes.json();
        document.body.classList.remove('loading');
        if (!genRes.ok) {
          document.getElementById('errorText').textContent = genData.detail || genData.error || genRes.statusText;
          errWrap.style.display = 'block';
          statusEl.textContent = '';
          return;
        }
        document.getElementById('outOptimal').textContent = typeof genData.optimalProduct === 'object'
          ? JSON.stringify(genData.optimalProduct, null, 2)
          : String(genData.optimalProduct || '-');
        document.getElementById('outAd').textContent = genData.adScript15s || '-';
        document.getElementById('outFeed').textContent = genData.feedPostCopy || '-';
        setSeoBlock(genData.seoPost);
        document.getElementById('resultOptimal').style.display = 'block';
        document.getElementById('resultAd').style.display = 'block';
        document.getElementById('resultFeed').style.display = 'block';
        wrap.style.display = 'block';
        lastGeneratedResult = genData;
        lastGeneratedStats = data.stats || null;
        document.getElementById('btnFormat').style.display = 'inline-block';
        statusEl.textContent = 'Firebase í†µê³„(' + data.count + 'ëª…) ê¸°ì¤€ìœ¼ë¡œ ìƒì„± ì™„ë£Œ.';
        statusEl.style.color = 'var(--accent)';
      } catch (e) {
        document.body.classList.remove('loading');
        statusEl.textContent = '';
        document.getElementById('errorText').textContent = e.message;
        errWrap.style.display = 'block';
      }
    };

    document.getElementById('btnSample').onclick = () => {
      document.getElementById('topScents').value = 'GREEN, FLORAL, WOODY_INK';
      document.getElementById('topProducts').value = 'Morning Mist of Namsan, The Princess\'s Flower Garden';
      document.getElementById('totalResponses').value = '156';
      document.getElementById('period').value = '7d';
      document.getElementById('extraStats').value = JSON.stringify({
        genderRatio: { female: 72, male: 26 },
        spaceRatio: { living_bedroom: 55, kitchen: 25, car: 20 }
      }, null, 2);
    };

    document.getElementById('btnGenerate').onclick = async () => {
      const topScents = document.getElementById('topScents').value.split(',').map(s => s.trim()).filter(Boolean);
      const topProducts = document.getElementById('topProducts').value.split(',').map(s => s.trim()).filter(Boolean);
      let extra = {};
      try {
        const raw = document.getElementById('extraStats').value.trim();
        if (raw) extra = JSON.parse(raw);
      } catch (e) {}

      const stats = {
        topScents,
        topProducts,
        totalResponses: parseInt(document.getElementById('totalResponses').value, 10) || 0,
        period: document.getElementById('period').value || '7d',
        ...extra
      };

      const wrap = document.getElementById('resultArea');
      const errWrap = document.getElementById('errorArea');
      errWrap.style.display = 'none';
      wrap.style.display = 'none';
      document.getElementById('btnFormat').style.display = 'none';
      document.getElementById('resultInstagram').style.display = 'none';
      document.getElementById('resultNaver').style.display = 'none';
      document.body.classList.add('loading');

      try {
        const res = await fetch(API_BASE + '/api/generate-prompts', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ stats })
        });
        const data = await res.json();
        document.body.classList.remove('loading');

        if (!res.ok) {
          document.getElementById('errorText').textContent = data.detail || data.error || res.statusText;
          errWrap.style.display = 'block';
          return;
        }

        document.getElementById('outOptimal').textContent = typeof data.optimalProduct === 'object'
          ? JSON.stringify(data.optimalProduct, null, 2)
          : String(data.optimalProduct || '-');
        document.getElementById('outAd').textContent = data.adScript15s || '-';
        document.getElementById('outFeed').textContent = data.feedPostCopy || '-';
        setSeoBlock(data.seoPost);
        document.getElementById('resultOptimal').style.display = 'block';
        document.getElementById('resultAd').style.display = 'block';
        document.getElementById('resultFeed').style.display = 'block';
        wrap.style.display = 'block';
        lastGeneratedResult = data;
        lastGeneratedStats = stats;
        document.getElementById('btnFormat').style.display = 'inline-block';
      } catch (e) {
        document.body.classList.remove('loading');
        document.getElementById('errorText').textContent = e.message;
        errWrap.style.display = 'block';
      }
    };

    document.getElementById('btnFormat').onclick = async () => {
      if (!lastGeneratedResult) return;
      const btn = document.getElementById('btnFormat');
      btn.disabled = true;
      btn.textContent = 'ë§Œë“¤ì–´ì§€ëŠ” ì¤‘â€¦';
      const opt = Array.isArray(lastGeneratedResult.optimalProduct) ? lastGeneratedResult.optimalProduct[0] : lastGeneratedResult.optimalProduct;
      const productName = (opt && (opt.name || opt.nameKo)) || '';
      try {
        const res = await fetch(API_BASE + '/api/format-for-social', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            feedPostCopy: lastGeneratedResult.feedPostCopy || '',
            seoPost: lastGeneratedResult.seoPost || {},
            productName: productName,
            topScents: (lastGeneratedStats && lastGeneratedStats.topScents) || [],
            topProducts: (lastGeneratedStats && lastGeneratedStats.topProducts) || []
          })
        });
        const text = await res.text();
        let data = {};
        try {
          data = text.startsWith('{') ? JSON.parse(text) : {};
        } catch (_) {
          if (text.trim().toLowerCase().startsWith('<!doctype') || text.trim().startsWith('<')) {
            document.getElementById('errorText').textContent = 'API ì„œë²„ì— ì—°ê²°ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ì´ ê¸°ëŠ¥ì€ Node ì„œë²„ê°€ í•„ìš”í•´ìš”.\n\në¡œì»¬ì—ì„œ ì‚¬ìš©í•˜ë ¤ë©´: p í´ë”ì—ì„œ npm run start:api ë¥¼ ì‹¤í–‰í•œ ë’¤, http://localhost:7000/prompt-generator.html ë¡œ ì ‘ì†í•´ ì£¼ì„¸ìš”.';
          } else {
            document.getElementById('errorText').textContent = 'ì‘ë‹µì„ ì½ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤: ' + text.slice(0, 200);
          }
          document.getElementById('errorArea').style.display = 'block';
          btn.disabled = false;
          btn.textContent = 'ì¸ìŠ¤íƒ€Â·ë¸”ë¡œê·¸ìš©ìœ¼ë¡œ ì˜ˆì˜ê²Œ ë§Œë“¤ê¸°';
          return;
        }
        btn.disabled = false;
        btn.textContent = 'ì¸ìŠ¤íƒ€Â·ë¸”ë¡œê·¸ìš©ìœ¼ë¡œ ì˜ˆì˜ê²Œ ë§Œë“¤ê¸°';
        if (!res.ok) {
          document.getElementById('errorText').textContent = data.detail || data.error || 'í¬ë§· ì‹¤íŒ¨';
          document.getElementById('errorArea').style.display = 'block';
          return;
        }
        document.getElementById('outInstagram').textContent = data.instagramCaption || '';
        document.getElementById('resultInstagram').style.display = 'block';
        const nb = data.naverBlogPost || {};
        const naverText = ['ì œëª©: ' + (nb.title || ''), 'ë©”íƒ€ ì„¤ëª…: ' + (nb.metaDescription || ''), '', 'ë³¸ë¬¸:', (nb.body || '')].join('\n');
        document.getElementById('outNaver').textContent = naverText;
        document.getElementById('resultNaver').style.display = 'block';
      } catch (e) {
        btn.disabled = false;
        btn.textContent = 'ì¸ìŠ¤íƒ€Â·ë¸”ë¡œê·¸ìš©ìœ¼ë¡œ ì˜ˆì˜ê²Œ ë§Œë“¤ê¸°';
        document.getElementById('errorText').textContent = e.message;
        document.getElementById('errorArea').style.display = 'block';
      }
    };

    function setSeoBlock(seoPost) {
      const block = document.getElementById('resultSeo');
      const out = document.getElementById('outSeo');
      if (!seoPost || typeof seoPost !== 'object') {
        block.style.display = 'none';
        return;
      }
      const lines = [
        'ì œëª©: ' + (seoPost.title || ''),
        'ë©”íƒ€ ì„¤ëª…: ' + (seoPost.metaDescription || ''),
        '',
        'ë³¸ë¬¸:',
        (seoPost.body || ''),
        '',
        'ì‚¬ìš© ì´ë¯¸ì§€ (assets í´ë”): ' + (seoPost.suggestedImage || ''),
        'í•´ì‹œíƒœê·¸: ' + (seoPost.hashtags || '')
      ];
      out.textContent = lines.join('\n');
      block.style.display = 'block';
    }

    document.querySelectorAll('[data-copy]').forEach(btn => {
      btn.addEventListener('click', (e) => {
        e.stopPropagation();
        const id = btn.getAttribute('data-copy');
        const el = document.getElementById(id);
        if (el) {
          navigator.clipboard.writeText(el.textContent);
          btn.textContent = 'ë³µì‚¬ë¨';
          setTimeout(() => { btn.textContent = 'ë³µì‚¬'; }, 1500);
        }
      });
    });

    document.getElementById('resultArea').addEventListener('click', (e) => {
      const header = e.target.closest('.result-toggle-header');
      if (!header || e.target.closest('button[data-copy]')) return;
      const toggle = header.closest('.result-toggle');
      if (toggle) toggle.classList.toggle('open');
    });
  </script>
</body>
</html>
